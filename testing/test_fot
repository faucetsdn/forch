#!/bin/bash -ex

DAQBASE=inst/forch-controller-1/daq

echo Controller startup log
docker logs forch-controller-1

echo DAQ log
cat $DAQBASE/inst/cmdrun.log

echo DAQ spot checks

# Basic process startup.
fgrep "Loading base module config" $DAQBASE/inst/cmdrun.log

# Testing that python path is good.
ls -l $DAQBASE/inst/daq.pid

# Requires valid config available.
cat $DAQBASE/inst/daq_run_id.txt

# Requiring mininet path.
ls -l $DAQBASE/inst/dp_port_acls.yaml

# Check that OVS switch connects properly to managed faucet.
fgrep "System port 1 on dpid 1 is active True" $DAQBASE/inst/cmdrun.log

echo Done with daq startup tests.
