/*
 * list_hosts API result
 */
syntax = "proto3";

/*
 * List of hosts
 */
message HostList {
    // List of hosts indexed by MAC addresses with networking information.
    map<string, HostData> eth_srcs = 1;

    // List of possible destined hosts indexed by destination MAC addresses.
    map<string, HostData> eth_dsts = 2;

    // Link for checking path to egres.
    string egress_url = 3;

    // link to system overview API
    string system_state_url = 4;

    // Data for each host
    message HostData {
        // access switch host connected to
        string switch = 1;

        // port host connected to
        int32 port = 2;

        // host IP
        string host_ip = 3;

        // VLAN
        int32 vlan = 4;

        // ACLs
        repeated string acls = 5;

        // link to list_hosts API to list possible destinations
        // or to host_path API to list path
        string url = 6;
    }

  message ACLState {
    // rule states indexed by rule cookies
    map<string, RuleState> rules = 1;

    message RuleState {
      // rule configuration in string format
      string rule_config_str = 1;

      // count of packets hit the rule
      int32 packet_count = 2;
    }
  }
}